#!/usr/sbin/nft -f

flush ruleset

table inet filter {
	chain input {
		type filter hook input priority 0; policy drop;
                iifname "lo" accept
                ct state established,related accept
                iifname "cassandra-shim" ip saddr 192.168.1.197 tcp dport 22 accept
                iifname "cassandra-shim" ip saddr 192.168.1.198 tcp dport 9042 accept
                ip protocol icmp icmp type echo-request accept
                #for debug
                ip saddr 192.168.1.1 tcp dport 22 accept
	}
	chain forward {
		type filter hook forward priority filter;
	}
	chain output {
		type filter hook output priority filter;
	}
}
